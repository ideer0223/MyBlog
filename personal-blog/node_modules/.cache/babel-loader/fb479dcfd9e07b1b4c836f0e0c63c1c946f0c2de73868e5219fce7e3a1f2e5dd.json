{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\n\n// 自动导入所有markdown文件\nconst importAll = r => {\n  let files = {};\n  r.keys().forEach(key => {\n    files[key] = r(key);\n  });\n  return files;\n};\n\n// 使用 require.context 自动导入 articles 目录下的所有 .md 文件\nconst markdownFiles = importAll(require.context('./articles', true, /\\.md$/));\n\n// 解析markdown文件的frontmatter\nconst parseFrontmatter = content => {\n  try {\n    // 使用更严格的正则表达式匹配frontmatter\n    const frontmatterRegex = /^---[\\r\\n]+([\\s\\S]*?)[\\r\\n]+---/;\n    const match = content.match(frontmatterRegex);\n    if (!match) {\n      console.error('No valid frontmatter found');\n      return null;\n    }\n    const frontmatterContent = match[1];\n    const frontmatter = {};\n\n    // 使用更可靠的方式解析每一行\n    frontmatterContent.split(/\\r?\\n/).forEach(line => {\n      const trimmedLine = line.trim();\n      if (trimmedLine && !trimmedLine.startsWith('#')) {\n        const separatorIndex = trimmedLine.indexOf(':');\n        if (separatorIndex !== -1) {\n          const key = trimmedLine.slice(0, separatorIndex).trim();\n          const value = trimmedLine.slice(separatorIndex + 1).trim();\n          // 移除值中的引号（如果存在）\n          frontmatter[key] = value.replace(/^['\"](.*)['\"]$/, '$1');\n        }\n      }\n    });\n\n    // 验证必要的字段\n    const requiredFields = ['title', 'date', 'category'];\n    const missingFields = requiredFields.filter(field => !frontmatter[field]);\n    if (missingFields.length > 0) {\n      console.error('Missing required frontmatter fields:', missingFields);\n      return null;\n    }\n    return frontmatter;\n  } catch (error) {\n    console.error('Error parsing frontmatter:', error);\n    return null;\n  }\n};\n\n// 从文件路径中提取年份\nconst extractDateFromPath = path => {\n  const match = path.match(/\\/(\\d{4})\\//);\n  if (!match) return null;\n  const year = parseInt(match[1]);\n  return {\n    year\n  };\n};\n\n// 加载所有文章数据\nconst loadArticles = async () => {\n  const articles = await Promise.all(Object.entries(markdownFiles).map(async ([path, module], index) => {\n    try {\n      var _content$split$find;\n      const response = await fetch(module.default);\n      const fileContent = await response.text();\n\n      // 解析frontmatter\n      const frontmatter = parseFrontmatter(fileContent);\n      const dateInfo = extractDateFromPath(path);\n      if (!frontmatter || !dateInfo) {\n        console.error(`Failed to parse article at ${path}`);\n        return null;\n      }\n\n      // 提取文章内容（移除frontmatter）\n      const content = fileContent.replace(/^---[\\r\\n]+([\\s\\S]*?)[\\r\\n]+---/, '') // 移除frontmatter\n      .trim();\n\n      // 提取摘要（第一个非空、非标题段落）\n      const summary = ((_content$split$find = content.split(/\\r?\\n/).find(line => line.trim() && !line.startsWith('#'))) === null || _content$split$find === void 0 ? void 0 : _content$split$find.trim()) || '';\n      return {\n        id: index + 1,\n        title: frontmatter.title,\n        date: frontmatter.date,\n        category: frontmatter.category,\n        path: path,\n        content: content,\n        summary: summary,\n        year: dateInfo.year,\n        month: parseInt(frontmatter.date.split('-')[1])\n      };\n    } catch (error) {\n      console.error(`Error loading article ${path}:`, error);\n      return null;\n    }\n  }));\n\n  // 按日期排序\n  return articles.filter(article => article !== null).sort((a, b) => new Date(b.date) - new Date(a.date));\n};\n\n// 获取按年份分组的文章\nexport const getArticlesByYear = articles => {\n  const groupedArticles = {};\n  articles.forEach(article => {\n    if (!groupedArticles[article.year]) {\n      groupedArticles[article.year] = [];\n    }\n    groupedArticles[article.year].push(article);\n  });\n  return groupedArticles;\n};\n\n// 获取按分类分组的文章\nexport const getArticlesByCategory = articles => {\n  const groupedArticles = {};\n  articles.forEach(article => {\n    if (!groupedArticles[article.category]) {\n      groupedArticles[article.category] = [];\n    }\n    groupedArticles[article.category].push(article);\n  });\n  return groupedArticles;\n};\n\n// 自定义Hook来获取文章数据\nexport const useArticles = () => {\n  _s();\n  const [articles, setArticles] = useState([]);\n  const [loading, setLoading] = useState(true);\n  useEffect(() => {\n    loadArticles().then(loadedArticles => {\n      console.log('Loaded articles:', loadedArticles);\n      setArticles(loadedArticles);\n      setLoading(false);\n    }).catch(error => {\n      console.error('Error in useArticles:', error);\n      setLoading(false);\n    });\n  }, []);\n  return {\n    articles,\n    loading\n  };\n};\n_s(useArticles, \"ByfW2W02M1Fj4gKraM3ZQ6w4KbM=\");\nexport default useArticles;","map":{"version":3,"names":["useEffect","useState","importAll","r","files","keys","forEach","key","markdownFiles","require","context","parseFrontmatter","content","frontmatterRegex","match","console","error","frontmatterContent","frontmatter","split","line","trimmedLine","trim","startsWith","separatorIndex","indexOf","slice","value","replace","requiredFields","missingFields","filter","field","length","extractDateFromPath","path","year","parseInt","loadArticles","articles","Promise","all","Object","entries","map","module","index","_content$split$find","response","fetch","default","fileContent","text","dateInfo","summary","find","id","title","date","category","month","article","sort","a","b","Date","getArticlesByYear","groupedArticles","push","getArticlesByCategory","useArticles","_s","setArticles","loading","setLoading","then","loadedArticles","log","catch"],"sources":["/Users/liucan/Downloads/EpointiOSFrameV7 2024-11-28 08-23-27/MyBlog/personal-blog/src/data/articles.js"],"sourcesContent":["import { useEffect, useState } from 'react';\n\n// 自动导入所有markdown文件\nconst importAll = (r) => {\n  let files = {};\n  r.keys().forEach((key) => {\n    files[key] = r(key);\n  });\n  return files;\n};\n\n// 使用 require.context 自动导入 articles 目录下的所有 .md 文件\nconst markdownFiles = importAll(\n  require.context('./articles', true, /\\.md$/)\n);\n\n// 解析markdown文件的frontmatter\nconst parseFrontmatter = (content) => {\n  try {\n    // 使用更严格的正则表达式匹配frontmatter\n    const frontmatterRegex = /^---[\\r\\n]+([\\s\\S]*?)[\\r\\n]+---/;\n    const match = content.match(frontmatterRegex);\n    \n    if (!match) {\n      console.error('No valid frontmatter found');\n      return null;\n    }\n\n    const frontmatterContent = match[1];\n    const frontmatter = {};\n\n    // 使用更可靠的方式解析每一行\n    frontmatterContent.split(/\\r?\\n/).forEach(line => {\n      const trimmedLine = line.trim();\n      if (trimmedLine && !trimmedLine.startsWith('#')) {\n        const separatorIndex = trimmedLine.indexOf(':');\n        if (separatorIndex !== -1) {\n          const key = trimmedLine.slice(0, separatorIndex).trim();\n          const value = trimmedLine.slice(separatorIndex + 1).trim();\n          // 移除值中的引号（如果存在）\n          frontmatter[key] = value.replace(/^['\"](.*)['\"]$/, '$1');\n        }\n      }\n    });\n\n    // 验证必要的字段\n    const requiredFields = ['title', 'date', 'category'];\n    const missingFields = requiredFields.filter(field => !frontmatter[field]);\n    \n    if (missingFields.length > 0) {\n      console.error('Missing required frontmatter fields:', missingFields);\n      return null;\n    }\n\n    return frontmatter;\n  } catch (error) {\n    console.error('Error parsing frontmatter:', error);\n    return null;\n  }\n};\n\n// 从文件路径中提取年份\nconst extractDateFromPath = (path) => {\n  const match = path.match(/\\/(\\d{4})\\//);\n  if (!match) return null;\n  const year = parseInt(match[1]);\n  return { year };\n};\n\n// 加载所有文章数据\nconst loadArticles = async () => {\n  const articles = await Promise.all(\n    Object.entries(markdownFiles).map(async ([path, module], index) => {\n      try {\n        const response = await fetch(module.default);\n        const fileContent = await response.text();\n        \n        // 解析frontmatter\n        const frontmatter = parseFrontmatter(fileContent);\n        const dateInfo = extractDateFromPath(path);\n        \n        if (!frontmatter || !dateInfo) {\n          console.error(`Failed to parse article at ${path}`);\n          return null;\n        }\n\n        // 提取文章内容（移除frontmatter）\n        const content = fileContent\n          .replace(/^---[\\r\\n]+([\\s\\S]*?)[\\r\\n]+---/, '') // 移除frontmatter\n          .trim();\n\n        // 提取摘要（第一个非空、非标题段落）\n        const summary = content\n          .split(/\\r?\\n/)\n          .find(line => line.trim() && !line.startsWith('#'))\n          ?.trim() || '';\n\n        return {\n          id: index + 1,\n          title: frontmatter.title,\n          date: frontmatter.date,\n          category: frontmatter.category,\n          path: path,\n          content: content,\n          summary: summary,\n          year: dateInfo.year,\n          month: parseInt(frontmatter.date.split('-')[1])\n        };\n      } catch (error) {\n        console.error(`Error loading article ${path}:`, error);\n        return null;\n      }\n    })\n  );\n\n  // 按日期排序\n  return articles\n    .filter(article => article !== null)\n    .sort((a, b) => new Date(b.date) - new Date(a.date));\n};\n\n// 获取按年份分组的文章\nexport const getArticlesByYear = (articles) => {\n  const groupedArticles = {};\n  articles.forEach(article => {\n    if (!groupedArticles[article.year]) {\n      groupedArticles[article.year] = [];\n    }\n    groupedArticles[article.year].push(article);\n  });\n  return groupedArticles;\n};\n\n// 获取按分类分组的文章\nexport const getArticlesByCategory = (articles) => {\n  const groupedArticles = {};\n  articles.forEach(article => {\n    if (!groupedArticles[article.category]) {\n      groupedArticles[article.category] = [];\n    }\n    groupedArticles[article.category].push(article);\n  });\n  return groupedArticles;\n};\n\n// 自定义Hook来获取文章数据\nexport const useArticles = () => {\n  const [articles, setArticles] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadArticles()\n      .then(loadedArticles => {\n        console.log('Loaded articles:', loadedArticles);\n        setArticles(loadedArticles);\n        setLoading(false);\n      })\n      .catch(error => {\n        console.error('Error in useArticles:', error);\n        setLoading(false);\n      });\n  }, []);\n\n  return { articles, loading };\n};\n\nexport default useArticles; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}